function [C] = C_q_m(q,dq)

  C(1,1)=q(4)d*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 +...
          (8*sin(q(2) + q(4)))/5 - (34029*sin(q(4)))/6250) - q(5)d*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 -...
          (512*sin(q(3) - q(2) + q(5)))/3125 + (512*sin(q(5)))/3125) - q(3)d*((5971*sin(q(2) - q(3)))/6250 + (512*...
         sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) +...
          q(5)))/3125) + q(2)d*((5971*sin(q(2) - q(3)))/6250 + (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) -...
          q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) + q(5)))/3125 + (8*sin(q(2) + q(4)))/5 + (8*sin(q(2)))/5);
  C(1,2)=q(4)d*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 +...
          (8*sin(q(2) + q(4)))/5 - (34029*sin(q(4)))/6250) + q(1)d*((5971*sin(q(2) - q(3)))/6250 + (512*...
         sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) +...
          q(5)))/3125 + (8*sin(q(2) + q(4)))/5 + (8*sin(q(2)))/5) + q(2)d*((5971*sin(q(2) - q(3)))/6250 + (512*sin(q(2) -...
          q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) + q(5)))/3125 + (8*...
         sin(q(2) + q(4)))/5 + (8*sin(q(2)))/5);
  C(1,3)=- q(5)d*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (512*sin(q(3) - q(2) + q(5)))/3125 +...
          (512*sin(q(5)))/3125) - q(1)d*((5971*sin(q(2) - q(3)))/6250 + (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 +...
          (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) + q(5)))/3125) - q(3)d*((5971*sin(q(2) -...
          q(3)))/6250 + (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) -...
          q(2) + q(5)))/3125);
  C(1,4)=((q(1)d + q(2)d + q(4)d)*(1024*sin(q(2) - q(3) + q(4) - q(5)) + 5971*sin(q(2) - q(3) +...
          q(4)) + 10000*sin(q(2) + q(4)) - 34029*sin(q(4))))/6250;
  C(1,5)=-(512*(sin(q(2) - q(3) + q(4) - q(5)) - sin(q(3) - q(2) + q(5)) + sin(q(5)))*(q(1)d +...
          q(3)d + q(5)d))/3125;
  C(2,1)=(512*q(1)d*sin(q(3) - q(2) + q(5)))/3125 - (512*q(3)d*sin(q(2) - q(3) + q(4) -...
          q(5)))/3125 - (512*q(5)d*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (5971*q(1)d*sin(q(2) - q(3) + q(4)))/6250 - (512*...
         q(1)d*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (5971*q(3)d*sin(q(2) - q(3) + q(4)))/6250 + (512*q(3)d*...
         sin(q(3) - q(2) + q(5)))/3125 + (512*q(5)d*sin(q(3) - q(2) + q(5)))/3125 - (8*q(1)d*sin(q(2) + q(4)))/5 - (8*...
         q(1)d*sin(q(2)))/5 - (34029*q(4)d*sin(q(4)))/6250 - (5971*q(1)d*sin(q(2) - q(3)))/6250 - (5971*q(3)d*...
         sin(q(2) - q(3)))/6250;
  C(2,2)=-(34029*q(4)d*sin(q(4)))/6250;
  C(2,3)=- q(1)d*((5971*sin(q(2) - q(3)))/6250 + (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*...
         sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) + q(5)))/3125) - q(3)d*((5971*sin(q(2) - q(3)))/6250 +...
          (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) +...
          q(5)))/3125) - q(5)d*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (512*sin(q(3) - q(2) + q(5)))/3125);
  C(2,4)=-(34029*sin(q(4))*(q(1)d + q(2)d + q(4)d))/6250;
  C(2,5)=-(512*(sin(q(2) - q(3) + q(4) - q(5)) - sin(q(3) - q(2) + q(5)))*(q(1)d + q(3)d + q(5)d))/3125;
  C(3,1)=q(1)d*((5971*sin(q(2) - q(3)))/6250 + (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*...
         sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) + q(5)))/3125) + q(2)d*((5971*sin(q(2) - q(3)))/6250 +...
          (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) +...
          q(5)))/3125) - (512*q(5)d*sin(q(5)))/3125 + q(4)d*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) -...
          q(3) + q(4)))/6250);
  C(3,2)=q(1)d*((5971*sin(q(2) - q(3)))/6250 + (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*...
         sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) + q(5)))/3125) + q(2)d*((5971*sin(q(2) - q(3)))/6250 +...
          (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) +...
          q(5)))/3125) + q(4)d*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250);
  C(3,3)=-(512*q(5)d*sin(q(5)))/3125;
  C(3,4)=((1024*sin(q(2) - q(3) + q(4) - q(5)) + 5971*sin(q(2) - q(3) + q(4)))*(q(1)d + q(2)d + q(4)d))/6250;
  C(3,5)=-(512*sin(q(5))*(q(1)d + q(3)d + q(5)d))/3125;
  C(4,1)=(34029*q(2)d*sin(q(4)))/6250 - (512*q(5)d*sin(q(2) - q(3) + q(4) - q(5)))/3125 - q(1)d*...
         ((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 + (8*sin(q(2) +...
          q(4)))/5 - (34029*sin(q(4)))/6250) - q(3)d*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) -...
          q(3) + q(4)))/6250);
  C(4,2)=(34029*sin(q(4))*(q(1)d + q(2)d))/6250;
  C(4,3)=- (512*q(5)d*sin(q(2) - q(3) + q(4) - q(5)))/3125 - q(1)d*((512*sin(q(2) - q(3) + q(4) -...
          q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250) - q(3)d*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*...
         sin(q(2) - q(3) + q(4)))/6250);
  C(4,4)=0;
  C(4,5)=-(512*sin(q(2) - q(3) + q(4) - q(5))*(q(1)d + q(3)d + q(5)d))/3125;
  C(5,1)=q(1)d*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (512*sin(q(3) - q(2) + q(5)))/3125 +...
          (512*sin(q(5)))/3125) + (512*q(4)d*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (512*q(3)d*sin(q(5)))/3125 +...
          q(2)d*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (512*sin(q(3) - q(2) + q(5)))/3125);
  C(5,2)=(512*q(4)d*sin(q(2) - q(3) + q(4) - q(5)))/3125 + q(1)d*((512*sin(q(2) - q(3) + q(4) -...
          q(5)))/3125 - (512*sin(q(3) - q(2) + q(5)))/3125) + q(2)d*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (512*...
         sin(q(3) - q(2) + q(5)))/3125);
  C(5,3)=(512*sin(q(5))*(q(1)d + q(3)d))/3125;
  C(5,4)=(512*sin(q(2) - q(3) + q(4) - q(5))*(q(1)d + q(2)d + q(4)d))/3125;
  C(5,5)=0;

 